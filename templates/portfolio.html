{% extends "base.html" %}

{% block title %}Portfolio Tracker - Career Dashboard{% endblock %}

{% block content %}
<div class="container">
    <h1 class="section-header">Portfolio Projects</h1>

    <!-- Portfolio Projects Grid -->
    <div class="grid">
        {% for project in data.portfolio %}
        <div class="portfolio-card card">
            <h3>{{ project.title }}</h3>
            <p>{{ project.description }}</p>

            <div style="margin: 15px 0;">
                <span class="badge badge-{{ project.phase }}">{{ project.phase|upper }}</span>
                {% if project.status == 'complete' %}
                <span class="badge badge-complete">Complete</span>
                {% elif project.status == 'in_progress' %}
                <span class="badge badge-active">In Progress</span>
                {% else %}
                <span class="badge badge-planned">Planned</span>
                {% endif %}
            </div>

            {% if project.github %}
            <div style="margin: 10px 0;">
                <a href="{{ project.github }}" target="_blank" rel="noopener noreferrer" class="btn btn-small">
                    View on GitHub
                </a>
            </div>
            {% endif %}

            <div class="form-group" style="margin-top: 15px;">
                <label for="status-{{ project.id }}">Update Status</label>
                <select id="status-{{ project.id }}" class="form-select" onchange="updateProjectStatus({{ project.id }}, this.value)">
                    <option value="planned" {% if project.status == 'planned' %}selected{% endif %}>Planned</option>
                    <option value="in_progress" {% if project.status == 'in_progress' %}selected{% endif %}>In Progress</option>
                    <option value="complete" {% if project.status == 'complete' %}selected{% endif %}>Complete</option>
                </select>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Certification Roadmap -->
    <div class="card" style="margin-top: 50px;">
        <h2 class="section-header">Certification Roadmap</h2>

        <table style="width: 100%; margin-top: 20px; border-collapse: collapse;">
            <thead>
                <tr>
                    <th style="text-align: left; padding: 10px; border-bottom: 2px solid #333;">Certification</th>
                    <th style="text-align: left; padding: 10px; border-bottom: 2px solid #333;">Target Month</th>
                    <th style="text-align: left; padding: 10px; border-bottom: 2px solid #333;">Phase</th>
                    <th style="text-align: left; padding: 10px; border-bottom: 2px solid #333;">Status</th>
                </tr>
            </thead>
            <tbody>
                {% for cert in data.certifications %}
                <tr>
                    <td style="padding: 10px; border-bottom: 1px solid #333;">{{ cert.name }}</td>
                    <td style="padding: 10px; border-bottom: 1px solid #333;">{{ cert.target_month }}</td>
                    <td style="padding: 10px; border-bottom: 1px solid #333;">
                        <span class="badge badge-{{ cert.phase }}">{{ cert.phase|upper }}</span>
                    </td>
                    <td style="padding: 10px; border-bottom: 1px solid #333;">
                        {% if cert.status == 'complete' %}
                        <span class="badge badge-complete">Complete</span>
                        {% elif cert.status == 'in_progress' %}
                        <span class="badge badge-active">In Progress</span>
                        {% elif cert.status == 'upcoming' %}
                        <span class="badge badge-upcoming">Upcoming</span>
                        {% else %}
                        <span class="badge badge-pending">Pending</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script>
async function updateProjectStatus(projectId, newStatus) {
    try {
        const response = await fetch(`/api/portfolio/${projectId}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ status: newStatus })
        });

        if (response.ok) {
            alert('Project status updated successfully!');
            location.reload();
        } else {
            alert('Failed to update project status');
        }
    } catch (error) {
        console.error('Error:', error);
        alert('Error updating project status');
    }
}
</script>

<style>
.portfolio-card {
    padding: 25px;
}

.portfolio-card h3 {
    margin: 0 0 10px 0;
    font-size: 20px;
    color: #4CAF50;
}

.portfolio-card p {
    color: #ccc;
    line-height: 1.6;
    margin: 10px 0;
}

.grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

table {
    color: #ccc;
}

th {
    color: #fff;
    font-weight: 600;
}
</style>
{% endblock %}
